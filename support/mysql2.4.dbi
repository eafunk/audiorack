ALTER TABLE [prefix]category_item ADD Added bigint(20) default NULL;
ALTER TABLE [prefix]category_item ADD KEY [prefix]category_item_added (Added);
ALTER TABLE [prefix]locations MODIFY ID int(10) unsigned NOT NULL default auto_increment;
UPDATE [prefix]queries SET SQLText = 'START TRANSACTION;\nSELECT @plid:= [select(playlist)], @ctid:= [select(category)];\nDELETE FROM [!prefix]category_item USING [!prefix]category_item, [!prefix]playlist WHERE [!prefix]category_item.Item = [!prefix]playlist.Value AND [!prefix]playlist.Property = \'ID\' AND [!prefix]playlist.ID = @plid AND [!prefix]category_item.Category = @ctid;\nINSERT INTO [!prefix]category_item (Item, Category, Added) SELECT DISTINCT [!prefix]toc.ID, @ctid AS CatID, UNIX_TIMESTAMP(NOW()) FROM [!prefix]toc, [!prefix]playlist WHERE [!prefix]toc.ID = [!prefix]playlist.Value AND [!prefix]playlist.Property = \'ID\' AND [!prefix]playlist.ID = @plid;\nCOMMIT;\n' WHERE ID = 50;
UPDATE [prefix]queries SET SQLText = 'DELETE FROM [!prefix]category_item USING [!prefix]category_item, [!prefix]playlist WHERE [!prefix]category_item.Item = [!prefix]playlist.Value AND [!prefix]playlist.Property = \'ID\' AND [!prefix]playlist.ID = [select(playlist)] AND [!prefix]category_item.Category = [select(category)]\n' WHERE ID = 54;
INSERT INTO [prefix]queries (Name,SQLText,ID) VALUES ('Added to Category after date','SELECT [!prefix]category_item.Item AS ItemID, [!prefix]toc.Name AS Name FROM [!prefix]category_item, [!prefix]toc WHERE [!prefix]category_item.Category = [select(category)] AND [!prefix]toc.ID = [!prefix]category_item.Item AND [!prefix]category_item.Added > UNIX_TIMESTAMP(\'[prompt(Enter date: YYYY-MM-DD)]\')','45');
INSERT INTO [prefix]queries (Name,SQLText,ID) VALUES ('Added to Category before date','SELECT [!prefix]category_item.Item AS ItemID, [!prefix]toc.Name AS Name FROM [!prefix]category_item, [!prefix]toc WHERE [!prefix]category_item.Category = [select(category)] AND [!prefix]toc.ID = [!prefix]category_item.Item AND [!prefix]category_item.Added > 0 AND [!prefix]category_item.Added < UNIX_TIMESTAMP(\'[prompt(Enter date: YYYY-MM-DD)]\')','44');
UPDATE [prefix]info SET Value = '2.5' WHERE Property = 'Version';
